nextflow_process {

    name "Test Process SPLIT_N_VARIANTS"
    script "modules/jvarkit/splitnvariants/main.nf"
    process "SPLIT_N_VARIANTS"
    config "./nextflow.config"
    tag "gitlab_ci"
    tag "modules"
    tag "modules/jvarkit"
    tag "modules/jvarkit/splitnvariants"

    test("COUNT") {

        when {
            params {
               method = "--variants-count 10"
             }
            process {
                """
                input[0] = [ [id:"bed"], [] ]
                input[1] = [
                    [id:"ref"],
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz"),
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz.tbi")
                    ]
                """
            }
        }

        then {
            assert process.success
            //assert snapshot(process.out).match()
        }

    }

    test("COUNT_BED") {

        when {
            params {
               method = "--variants-count 10"
            }
            process {
                """
                input[0] = [ [id:"bed"], file("${projectDir}/tests/data/rotavirus_rf.01.bed") ]
                input[1] = [
                    [id:"ref"],
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz"),
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz.tbi")
                    ]
                """
            }
        }

        then {
            assert process.success
            //assert snapshot(process.out).match()
        }

    }


 test("N_VCF") {

        when {
            params {
               method = "--vcf-count 3"
            }
            process {
                """
                input[0] = [ [id:"bed"], [] ]
                input[1] = [
                    [id:"ref"],
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz"),
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz.tbi")
                    ]
                """
            }
        }

        then {
            assert process.success
            //assert snapshot(process.out).match()
        }

    }

    test("N_VCF_BED") {

        when {
            params {
               method = "--vcf-count 3"
            }
            process {
                """
                input[0] = [ [id:"bed"], file("${projectDir}/tests/data/rotavirus_rf.01.bed") ]
                input[1] = [
                    [id:"ref"],
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz"),
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz.tbi")
                    ]
                """
            }
        }

        then {
            assert process.success
            //assert snapshot(process.out).match()
        }

    }


    test("STUB") {
	options "-stub"
        when {
            params {
               method = "--vcf-count 3"
            }
            process {
                """
                input[0] = [ [id:"bed"], file("${projectDir}/tests/data/rotavirus_rf.01.bed") ]
                input[1] = [
                    [id:"ref"],
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz"),
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz.tbi")
                    ]
                """
            }
        }

        then {
            assert process.success
            //assert snapshot(process.out).match()
        }

    }


/**
test("DISTANCE") {

        when {
            params {
               method = "--distance 500"
            }
            process {
                """
                input[0] = [ [id:"bed"], [] ]
                input[1] = [
                    [id:"ref"],
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz"),
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz.tbi")
                    ]
                """
            }
        }

        then {
            assert process.success
            //assert snapshot(process.out).match()
        }

    }

    test("DISTANCE_BED") {

        when {
            params {
               method = "--distance 500"
            }
            process {
                """
                input[0] = [ [id:"bed"], file("${projectDir}/tests/data/rotavirus_rf.01.bed") ]
                input[1] = [
                    [id:"ref"],
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz"),
                    file("${projectDir}/tests/data/rotavirus_rf.vcf.gz.tbi")
                    ]
                """
            }
        }

        then {
            assert process.success
            //assert snapshot(process.out).match()
        }

    }
**/
}
