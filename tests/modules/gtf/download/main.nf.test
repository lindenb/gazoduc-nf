nextflow_process {

    name "Test Process DOWNLOAD_GTF_OR_GFF3"
    script "modules/gtf/download/main.nf"
    process "DOWNLOAD_GTF_OR_GFF3"
    tag "modules"
    tag "modules/gtf"
    tag "modules/gtf/download"
        config "./nextflow.config"

    test("GTF_HG19") {
        when {
            params {
               ucsc_name = "hg19"
               suffix   = "gtf"
            }
            process {
                """
	            input[0] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.fa")]
                input[1] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.fa.fai")]
                input[2] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.dict")]
                """
            }
        }

        then {
            assert process.success
            //assert snapshot(process.out).match()
        }
    }


    test("GFF_HG19") {
        when {
            params {
               ucsc_name = "hg19"
               suffix   = "gff3"
            }
            process {
                """
	            input[0] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.fa")]
                input[1] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.fa.fai")]
                input[2] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.dict")]
                """
            }
        }

        then {
            assert process.success
            //assert snapshot(process.out).match()
        }
    }



    test("GTF_HG38") {
        when {
            params {
               ucsc_name = "hg38"
               suffix   = "gtf"
            }
            process {
                """
	            input[0] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.fa")]
                input[1] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.fa.fai")]
                input[2] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.dict")]
                """
            }
        }

        then {
            assert process.success
            //assert snapshot(process.out).match()
        }
    }


    test("GFF_HG38") {
        when {
            params {
               ucsc_name = "hg38"
               suffix   = "gff3"
            }
            process {
                """
	            input[0] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.fa")]
                input[1] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.fa.fai")]
                input[2] = [[id:"r"],file("${projectDir}/tests/data/rotavirus_rf.dict")]
                """
            }
        }

        then {
            assert process.success
            //assert snapshot(process.out).match()
        }
    }


}
