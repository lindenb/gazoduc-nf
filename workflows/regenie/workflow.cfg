params {
	prefix = ""
	outdir = "results"
	help = false

	/* TSV file with sample	status=case|control	sex=male|female|undefined , optional column 'population' */
	samplesheet = "NO_FILE"
	
	/** vcf file , or if the suffix is '.list' , paths to the VCF  files */
	vcf = "NO_FILE"

	/** limit to that BED file */
	bed = "NO_FILE"

	/** pop in gnomad */
	gnomad_population = "AF_nfe"

	/** optional STEP1 loco file if saved from a previous study */
	step1_loco = "NO_FILE"

	/** optional COVARIATE file if provided by user , otherwise use PCA */
	covariate = "NO_FILE"

	/** named tests, comma separated  */
	vc_tests = "skato,acato-full,skat,skato-acat,acatv,acato"

	/** frequencies, comma separated */
	freq = "0.01,0.001"
	vc_maxAAF="0.01"

	/** status name */
	status = "status"
	/** weight column for step 2 */
	weight_column = 4

	/* sliding window size: ([window_size,window_shift])+ */
	sliding_windows=""

	/** custom user bed chrom/start/end/gene_name[/score] */
	select_bed = "NO_BED"

	/* treshold for digest file , hide pvalue lower than this value */
	digest_treshold  = 7.0
	}

conda.enabled=true

process {

	withName : "VCF_TO_INTERVALS" {
		ext.distance = "5M"
		ext.min_distance = "100"
		}
	withName : "WGSELECT" {
                label = "process_quick"
		memory = "3G"
		errorStrategy = "terminate"
		}

	withName : "MAKE_VCF" {
                label = "process_short"
		errorStrategy = "terminate"
		}
	withName : "ANNOT_VCF" {
                label = "process_short"
		errorStrategy = "terminate"
		}

	withName : "LD_PRUNING" {
                label = "process_medium"
        }

        withName : "PLOT_PCA" {
                publishDir = [
                path: {"${params.outdir}/PCA"},
                saveAs: { filename -> "${params.prefix}$filename" },
                mode: "copy",
                pattern : '*.{png,svg,pdf}',
                overwrite : true
                ]
        }

	withName: "QQPLOT" {
		publishDir = [
                path: {"${params.outdir}/REGENIE"},
                mode: "copy",
                pattern : '*.{png}',
                overwrite : true
                ]
	}

        withName : "PLOT_AVERAGE_PIHAT" {
                publishDir = [
                path: {"${params.outdir}/PCA"},
                saveAs: { filename -> "${params.prefix}$filename" },
                mode: "copy",
                pattern : '*.{png,svg,pdf}',
                overwrite : true
                ]
        }


	withName : "STEP1" {
                label = "process_high"
                publishDir = [
                path: {"${params.outdir}/REGENIE"},
                mode: "copy",
                pattern : '*.{loco}',
                overwrite : true
                ]
        }


	withName : "MAKE_COVARIATES" {
                publishDir = [
                path: {"${params.outdir}/PCA"},
                saveAs: { filename -> "${params.prefix}$filename" },
                mode: "copy",
                pattern : '*.tsv',
                overwrite : true
                ]
	}

	withName : "MAKE_PDF_ARCHIVE" {
                publishDir = [
                path: {"${params.outdir}/REGENIE"},
                mode: "copy",
                pattern : '*.zip',
                overwrite : true
                ]
	}

	withName : "MERGE_AND_PLOT" {
                publishDir = [
                path: {"${params.outdir}/REGENIE"},
                saveAs: { filename -> "${params.prefix}$filename" },
                mode: "copy",
                pattern : '*.{gz,tbi}',
                overwrite : true
                ]
        }


	withName : "ANNOT_HITS" {
                publishDir = [
                path: {"${params.outdir}/REGENIE"},
                saveAs: { filename -> "${params.prefix}$filename" },
                mode: "copy",
                pattern : '*.{tsv}',
                overwrite : true
                ]
        }

}

