params {
	gtf=null
	ucsc_name = null
	dbsnp = null
	method = "gvcf" // or bam2vcf or direct
	gvcf_merge_method="combinegvcfs" // or glnexus
}
includeConfig "../../../config/nextflow.config"

params {
	/** required file , CSV, : bam(bai,fasta,fai,sex) */
	samplesheet = null
	bed = null


	makewindows_args = "-w 1000000 -s 999900"
    bed_cluster_args = "--size 1Mb " // callers like gatk+gvcf
	method = "gvcf" // how to analyse : gvcf
	}

process {

withName : "PREPARE_REFERENCE:SCATTER_TO_BED:SCATTER_INTERVALS_BY_NS" {
	ext.output_type = "ACGT"
	ext.max_to_merge = 1
}

withName: "BEDTOOLS_MAKEWINDOWS" {
		ext.args = {params.makewindows_args}
		}
/** for callers like hapcaller+gvcf */

withName: "BED_CLUSTER" {
		ext.args = {params.bed_cluster_args}
		}



withName: "HAPLOTYPECALLER:FIND_GVCF_BLOCKS" {
	
	ext.args1 = "--block-size 50kb --merge-size 1kb"
	}


withName: "HAPLOTYPECALLER:BCFTOOLS_CONCAT" {
   publishDir = [
        path:"${params.outdir}/haplotypecaller",
		saveAs: { filename -> "${params.prefix}${filename}" },
        mode: "copy",
        pattern : '*.{bcf,vcf.gz,tbi,csi,md5}',
        overwrite : true
        ]
	}

withName: "GATK_BAM2VCF:BCFTOOLS_CONCAT:CONCAT2" {
   publishDir = [
        path:"${params.outdir}/haplotypecaller",
		saveAs: { filename -> "${params.prefix}${filename}" },
        mode: "copy",
        pattern : '*.{bcf,vcf.gz,tbi,csi,md5}',
        overwrite : true
        ]
   }

withName: "HAPLOTYPECALLER_DIRECT:BCFTOOLS_CONCAT:CONCAT2" {
   publishDir = [
        path:"${params.outdir}/haplotypecaller",
		saveAs: { filename -> "${params.prefix}${filename}" },
        mode: "copy",
        pattern : '*.{bcf,vcf.gz,tbi,csi,md5}',
        overwrite : true
        ]
	}




withName: "MULTIQC:MQC1" {
       publishDir = [
                path:"${params.outdir}/multiqc/all",
				saveAs: { filename -> "${params.prefix}${filename}" },
                mode: "copy",
                pattern : '*.{zip,html}',
                overwrite : true
                ]
	}

withName: "MULTIQC:MQC2" {
       publishDir = [
                path:"${params.outdir}/multiqc/per_pop",
				saveAs: { filename -> "${params.prefix}${filename}" },
                mode: "copy",
                pattern : '*.{zip,html}',
                overwrite : true
                ]
	}	


}

/*
profiles {
	"nautilus" {
		process {
			withName: "GATK_BAM2VCF:BAM2VCF|HAPLOTYPECALLER:HAPCALLER|HAPLOTYPECALLER:COMBINE_GENOTYPE_GVCFS:COMBINE_GVCFS:HC_COMBINE2|HAPLOTYPECALLER:COMBINE_GENOTYPE_GVCFS:COMBINE_GVCFS:HC_COMBINE1|HAPLOTYPECALLER:FIND_GVCF_BLOCKS|HAPLOTYPECALLER:HAPCALLER" {
				array=100
			}
		}
	}
	

}
*/
