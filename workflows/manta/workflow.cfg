//includeConfig("../../confs/default.params.cfg")
//includeConfig("../../confs/by_app/truvari.cfg")

params {
	prefix = ""
	help = false
	outdir = "results"
	/** fasta stuff */
	fasta = "NO_FILE"
	fai = "NO_FILE"
	dict = "NO_FILE"

	/** TSV samplesheet with header sample/bam/bai[/fasta/fai] */
	samplesheet = "NO_FILE"

	/** limit to those contigs */
	regex_contig = "(chr)?[0-9XY]*"

	/** restrict to that tabix-indexed bed */
	bed = "NO_FILE"

	/** try to merge manta files at the end ? */
	with_merge_manta_vcf = false
	}

/** END PARAMS */

conda.enabled=true
conda.useMicromamba=true


process {
errorStrategy = "retry"
maxRetries = 4


withName: "APPLY_MANTA_SINGLE" {
        clusterOptions = {task.attempt==1?"--qos=quick":(task.attempt==2?"--qos=short":"--qos=medium")}
        queue = {"standard" }
        cpus={task.attempt==1?10:1}
        memory = {task.attempt==1?"50.GB":"200GB"}
        time = {task.attempt==1?"3h":"24h"}

         publishDir = [
                path: {"${params.outdir}/samples/${sample}"},
                saveAs: { filename -> "${params.prefix}$filename" },
                mode: "copy",
                pattern : '*.{bcf,csi,vcf.gz,tbi}',
                overwrite : true
                ]
	}
}

