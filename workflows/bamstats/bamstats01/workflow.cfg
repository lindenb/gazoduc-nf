
plugins {
  id 'nf-schema@2.0.0'
}

params {
	/** shall we use samtools stats ? */
	with_samtools_stats = true

	/** shall we use samtools flagstat ? */
	with_samtools_flagstat = true

	/** shall we use samtools idxstats */
	with_samtools_idxstats = true

	/** shall we use picard CollectWgsMetrics ? */
	with_CollectWgsMetrics = true

	/** use mosdepth */
	with_mosdepth = true

	/** use somalier */
	with_somalier = true

        /* optional path to TSV : sample(TAB)pop to plot boxplot */
	sample2pop = "NO_FILE"

	/** limit to that bed */
	bed = "NO_FILE"

	mosdepth_version="0.3.8"

	/** TODO add somalier_version */

	sample2population = "NO_FILE"
	}


process {

/*

TODO: fixit
	withName: "BAMSTATS:MOSDEPTH_RUN_01" {
		cpus = 5
        }*/

	withName: "MULTIQC_1" {
                publishDir = [
                path:"${params.outdir}/MULTIQC",
                mode: "copy",
                pattern : '*.{zip}',
                overwrite : true
                ]
        }

	withName: "MULTIQC_2" {
                publishDir = [
                path:"${params.outdir}/MULTIQC",
                mode: "copy",
                pattern : '*.{zip}',
                overwrite : true
                ]
        }

	withName : "ZIP_IT" {
                publishDir = [
                path:"${params.outdir}/ZIP/",
                mode: "copy",
                saveAs: {F->F.startsWith("${params.prefix?:""}")?"${F}":"${params.prefix?:""}${F}"} ,
                pattern : '*.zip',
                overwrite : true
                ]
	}


	withName : "SOMALIER_BAMS_01:RELATE_SOMALIER" {
                publishDir = [
                path:"${params.outdir}/SOMALIER/",
                mode: "copy",
                saveAs: {F->F.startsWith("${params.prefix?:""}")?"${F}":"${params.prefix?:""}${F}"} ,
                pattern : '*.zip',
                overwrite : true
                ]
	}

}
