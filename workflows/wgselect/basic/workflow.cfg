

params {
	help = false
	outdir = "results"
	fasta  = "NO_FILE"
	fai = "NO_FILE"
	dict = "NO_FILE"
	/** indexed VCF or a list of vcf with the .list suffix */
	vcf = "NO_FILE"
	/** pedigree */
	pedigree = "NO_FILE"
	/* limit to that bed */
	bed = "NO_FILE"

	gatk_hardfiltering_percentile = 0.001

	}

includeConfig("../../../subworkflows/wgselect/workflow.cfg")

conda.enabled = true


process {

/* withName: "WGSELECT_02:VCF_TO_BED" {
        ext.with_header = false
        }
withName: "WGSELECT_02:JVARKIT_VCF_TO_INTERVALS_01:VCF_TO_BED" {
        ext.with_header = false
        }
*/

withName : "WGSELECT_02:JVARKIT_GATK_HARD_FILTERING_01:FOR_EACH_INTERVAL" {
	ext.percentile= {params.gatk_hardfiltering_percentile}
	}

withName : "WGSELECT_02:JVARKIT_GATK_HARD_FILTERING_01:CONCAT_TABLES" {
	ext.percentile= {params.gatk_hardfiltering_percentile}
	}


withName: "WGSELECT_02:WGSELECT_01:WGSELECT_EXCLUDE_BED_01:SCATTER_TO_BED:SCATTER_INTERVALS_BY_NS" {
	ext.type = "N"
	ext.max_to_merge = 1
	}

withName: "WGSELECT_02:JVARKIT_VCF_TO_INTERVALS_01:CONCAT_FILES_01" {
	ext.suffix = ".bed"
	}


withName: "WGSELECT_02:JVARKIT_GATK_HARD_FILTERING_01:CONCAT_TABLES" {
                publishDir = [
		path:"${params.outdir}",
		mode: "copy",
		pattern : '*.{pdf}',
		overwrite : true
                ]
        }


withName: "WGSELECT_02:WGSELECT_01:DIGEST_VARIANT_LIST" {
                publishDir = [
		path:"${params.outdir}",
		mode: "copy",
		pattern : '*.wgselect.count.tsv',
		overwrite : true
                ]
        }

withName: "WGSELECT_02:WGSELECT_01:BCFTOOLS_CONCAT:LEVEL2" {
                publishDir = [
		saveAs: { filename -> "${params.prefix}$filename" },
                path:"${params.outdir}/vcf",
                mode: "copy",
                pattern : '*.{bcf,vcf.gz,tbi,csi}',
                overwrite : true
                ]
        }


}

