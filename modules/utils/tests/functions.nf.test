
nextflow_function {

    name "Test Functions"
    script "modules/utils/functions.nf"
    tag "modules/utils/functions.nf"
    tag "modules/utils"
    tag "modules/utils/functions"
    tag "modules/utils/functions.nf"
    tag "functions"
    tag "gitlab_ci"

    test("flatMapByIndex") {
        function "flatMapByIndex"
        when {
            function {
                """
                input[0] = ["A",[1,2,3,4,5],"B"]
                input[1] = 1
                """
            }
        }
        then {
            assert function.success
        }
    }
	

    test("Test Function parseBoolean") {
        function "parseBoolean"
        when {
            function {
                """
                input[0] = "true"
                """
            }
        }
        then {
            assert function.success
        }
    }


    test("extractIlluminaName: ORA") {
        function "extractIlluminaName"
        when {
            function {
                """
                input[0] = "Data/DragenGermline/ora_fastq/4-0122-T-F_S16_L003_R1_001.fastq.ora"
                """
            }
        }
        then {
            assert function.success
	    assert function.result != null
	    assert function.result.sample == "4-0122-T-F"
	    assert function.result.id == "4-0122-T-F"
	    assert function.result.index == "S16"
	    assert function.result.lane == "L003"
	    assert function.result.side == "R1"
	    assert function.result.split == "001"
        }
    }


    test("extractIlluminaName: FQ_GZ") {
        function "extractIlluminaName"
        when {
            function {
                """
                input[0] = "Data/DragenGermline/ora_fastq/4-0122-T-F_S16_L003_R1_001.fastq.gz"
                """
            }
        }
        then {
            assert function.success
	    assert function.result != null
	    assert function.result.sample == "4-0122-T-F"
	    assert function.result.id == "4-0122-T-F"
	    assert function.result.index == "S16"
	    assert function.result.lane == "L003"
	    assert function.result.side == "R1"
	    assert function.result.split == "001"
        }
    }



    test("removeCommonSuffixes: FQ_GZ") {
        function "removeCommonSuffixes"
        when {
            function {
                """
                input[0] = "4-0122-T-F_S16_L003_R1_001.fastq.gz"
                """
            }
        }
        then {
            assert function.success
	    assert function.result == "4-0122-T-F_S16_L003_R1_001"
        }
    }



    test("verify") {
        function "verify"
        when {
            function {
                """
                input[0] = true
                input[1] = "OK"
                """
            }
        }
        then {
            assert function.success
        }
    }



	


	

}
